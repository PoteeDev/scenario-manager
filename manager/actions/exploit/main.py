from actions._base import BaseAction, Action
import os


class ExploitAction(BaseAction):
    def send(self, params):
        exploits, round = params[0], params[1]
        for exploit_name, values in exploits.items():
            if round in values["rounds"]:
                request = {
                    **self.__dict__,
                    "extra": exploit_name,
                    "args": ["exploit", f"{self.srv}.{self._domain}", exploit_name],
                }
                yield request

    def receive(self, response: Action):
        return {response.extra: int(response.answer)}
